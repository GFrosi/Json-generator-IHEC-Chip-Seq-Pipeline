# Json-generator-IHEC-Chip-Seq-Pipeline

This script generate a json Input file (single and pairend) to IHEC Chip-Seq Pipeline from a dataframe with IPs and INPUT samples and SRR ids information.

## You should first create a table (dataframe) with the follow informations:

|GSM | SRX | SRR | Categories|
|-----------|:-----------:|:--------:|------------|
|GSM2801176 | SRX3236723 | SRR6124070 | Trait|
|GSM2801187 | SRX3236734 | SRR6124081 | Trait|
|GSM1415874 | SRX610759 | SRR1425172 | Trait|
GSM1565791 | SRX818183 | SRR1725759,SRR1725760 | Trait|


### Command line
1. python gsm_seq.py -t gsm-srr-srx-categories.csv -p srr/
  - "-t": dataframe as exemplified above
  - "-p": root path to SRR samples download from NCBI, for instance. This directory will be read to identify if each IP/Input samples has just SRR_1 (SE) or SRR_1 and SRR_2 (PE)
  - This comand will return a dataframe with the SE/PE information per sample. 

2. python chipseq_json_generator.py -t gsm-srr-srx-categories.csv -c config/json_config.ini -s data/seq_type.csv -p chip 
 - "-t": dataframe as exemplified above
 - "-c": you should pass the json_config.ini. If you want to change any information (as memory, time per step, name of chip.title or description) you shpuld to modify this file before to run this command line
 - "-s": the seq_type.csv file generated by the first command line
 - "-p": output directory

### ihec_json_noinput.py

If you want to run the pipeline without Input samples, this script will get the json generated before and remove the ctl.fastqs keys and update the title and description information

3. python ihec_json_noinput.py -p json_files/ -o test_argparser_out/
 - "-p": path to directory with the complete json files
 - "-o": path to output directory

### md5-gsm-dict.py

Script to create a dictionary where the key is the md5sum corresponding to the EpiATLAS sample, and the value is the EGAR+bigwig extension (pval, fc, raw or ctl-raw).

4. python md5-gsm-dict.py <path_to_epiatlas.json>


### epirr_finder.py
Script to looking for the if the 'registry_id' key (which stores the EpiRR information) exist in other keys stored in the dataset_name (missing_json created from the ihec and final_json - hg19-release 2019-11). This scripts returns a dictionary where the keys are the keys names from dataset_name and the value is the counter of registry_id matches).

5. python epitt_finder.py <path_to_missingds.json>


### get_dataset_md5_jsons.py

Script to find dataset names from a list of md5sum generated from a specific IHEC/Final assembly-release json files (i.e hg38-2019-11_final.json. From the dataset names list the program will check if there is an overlap with the another json file (from another assembly; i.e hg19). This list of md5sum will be returned in a txt file.
To run this program you should pass the firs json file (i.e hg38_final.json), a list of md5sum filtered from this json, and the another json file to check if there is an overlap. 

6. python get_dataset_md5_jsons.py -p hg38_2019-11_final.json -l list_md5_hg38.txt -d hg19_2019-11_final.json 


 
